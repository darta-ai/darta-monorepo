apiVersion: traefik.containo.us/v1alpha1
kind: IngressRoute
metadata:
  name: my-ingressroute
spec:
  entryPoints:
  - web
  - websecure
  routes:
  - match: Host(`darta.works`) && PathPrefix(`/`)
    kind: Rule
    services:
    - name: next
      namespace: darta-next
      port: 1169
    middlewares:
    - name: https-redirect
  - match: Host(`www.darta.works`) && PathPrefix(`/`)
    kind: Rule
    services:
    - name: next
      namespace: darta-next
      port: 1169
    middlewares:
    - name: https-redirect
  # Adding a new rule for the API
  - match: Host(`api.darta.works`) && PathPrefix(`/`)
    kind: Rule
    services:
    - name: api-server
      namespace: darta-api
      port: 1160
    middlewares:
    - name: https-redirect
  tls:
    secretName: my-tls-secret
